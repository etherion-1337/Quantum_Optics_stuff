(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     15310,        365]
NotebookOptionsPosition[     14767,        342]
NotebookOutlinePosition[     15104,        357]
CellTagsIndexPosition[     15061,        354]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]", "=", "0.867"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]0", "=", 
   RowBox[{"87", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "6"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]0", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Lambda]", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "6"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Omega]0", "*", "\[Pi]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z0", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Omega]0", "^", "2"}], ")"}], "*", 
     RowBox[{"\[Pi]", "/", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lens", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", "\"\</home/qitlab/Documents/ThorlabsAC.xls\>\"", "]"}], 
    "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixForm", "[", "Lens", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"g", "[", "lens_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "R1", ",", "R2", ",", " ", "R3", ",", " ", "tc1", ",", " ", 
        "tc2", ",", " ", "n1", ",", " ", "n2", ",", " ", "plot", ",", " ", 
        "legend", ",", " ", "anglediffcalc"}], "}"}], ","}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"column2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "42"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"column3", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "42"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "43"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", "\n", 
     RowBox[{
      RowBox[{"efl", "=", 
       RowBox[{"Lens", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"5", "+", "i"}], ")"}], ",", "10"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"column2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"theta3", "[", "0.3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"column3", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"spotsize", "[", "0.3", "]"}]}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spotsize", "[", "d_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"z", ",", "M", ",", "\[Omega]03"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"z", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "*", "efl"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"d", "-", "efl"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"z", "/", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]03", "=", 
       RowBox[{"\[Omega]0", "*", "M"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "\[Omega]03", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.617423581860264*^9, 3.6174236306664047`*^9}, {
   3.6174237230766773`*^9, 3.617423766816957*^9}, 3.6174238184773912`*^9, {
   3.617423858090867*^9, 3.617423911464285*^9}, 3.617423962934203*^9, {
   3.6174848838913927`*^9, 3.6174848875673437`*^9}, {3.61748491896821*^9, 
   3.617484968846808*^9}, {3.617485294206609*^9, 3.617485294356389*^9}, {
   3.617485374024276*^9, 3.6174854156474743`*^9}, {3.617485661719524*^9, 
   3.6174856621515207`*^9}, 3.6174869809678926`*^9, {3.6174870146791162`*^9, 
   3.6174870158422203`*^9}, {3.617487056678838*^9, 3.6174870627142563`*^9}, {
   3.61748714857342*^9, 3.617487154968981*^9}, {3.617487277081503*^9, 
   3.617487529575598*^9}, {3.617487863582065*^9, 3.6174878736880283`*^9}, {
   3.6174881037304068`*^9, 3.6174881617157793`*^9}, {3.617488204070359*^9, 
   3.6174882128628407`*^9}, {3.6174947204441013`*^9, 3.617494725116108*^9}, {
   3.617494885758342*^9, 3.617494892607914*^9}, {3.617494991838627*^9, 
   3.6174950108748217`*^9}, {3.617495090502061*^9, 3.617495187458436*^9}, {
   3.617495305301942*^9, 3.617495359648958*^9}, {3.617495745652934*^9, 
   3.617495807406793*^9}, {3.617495838171937*^9, 3.617495838546698*^9}, {
   3.617495873393126*^9, 3.617495881686185*^9}, {3.617495953661903*^9, 
   3.617496059524784*^9}, {3.617496321532023*^9, 3.617496365249776*^9}, {
   3.617497443322208*^9, 3.6174974447058277`*^9}, {3.617498367593906*^9, 
   3.617498398242404*^9}, {3.617499715994492*^9, 3.6174997951003*^9}, {
   3.617500174087187*^9, 3.617500196417616*^9}, {3.617500417159223*^9, 
   3.617500439298409*^9}, {3.6175064536016273`*^9, 3.6175064558449373`*^9}, {
   3.617506558229347*^9, 3.6175066321315203`*^9}, {3.617506664357999*^9, 
   3.6175067274155483`*^9}, {3.617506757654586*^9, 3.617506790261559*^9}, {
   3.617506840002*^9, 3.6175069110487022`*^9}, {3.6175071731591167`*^9, 
   3.617507174188855*^9}, {3.617507286925022*^9, 3.617507317677126*^9}, {
   3.617507362225916*^9, 3.617507365456905*^9}, {3.617507447090488*^9, 
   3.617507448539963*^9}, {3.6175077246151657`*^9, 3.617507757674246*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"theta3", "[", "d_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"z", ",", "M", ",", " ", "\[Omega]03", ",", " ", "\[Theta]3"}],
        " ", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"z", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "*", "efl"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"d", "-", "efl"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{"z", "/", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]03", "=", 
        RowBox[{"\[Omega]0", "*", "M"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]3", "=", 
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Lambda]", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "6"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"\[Pi]", "*", "\[Omega]03"}], ")"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "\[Theta]3", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"column2", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"column3", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "42"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\</home/qitlab/Documents/data30tl.xls\>\"", ",", "data"}], 
   "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.617487987590871*^9, 3.617488094288227*^9}, {
   3.6174881807641172`*^9, 3.617488183841107*^9}, {3.617488220951643*^9, 
   3.617488261578245*^9}, 3.617488347640645*^9, {3.617488420588653*^9, 
   3.61748848461685*^9}, {3.617494682420068*^9, 3.617494683182806*^9}, {
   3.6174947762562523`*^9, 3.617494781883399*^9}, {3.6174948457363253`*^9, 
   3.617494860521397*^9}, {3.6174974769424343`*^9, 3.617497588062882*^9}, {
   3.617497628491539*^9, 3.617497766597734*^9}, {3.617497801993374*^9, 
   3.617497824750071*^9}, {3.61749786660813*^9, 3.617497878953561*^9}, {
   3.617498358077566*^9, 3.617498385733197*^9}, {3.617499723554874*^9, 
   3.617499724467555*^9}, {3.617499756054902*^9, 3.617499802307736*^9}, {
   3.617500162203979*^9, 3.6175001625162888`*^9}, {3.6175002018076267`*^9, 
   3.617500202388434*^9}, {3.617500407341954*^9, 3.617500428851515*^9}, {
   3.617507405652977*^9, 3.617507486244182*^9}, {3.617507557030633*^9, 
   3.617507618021962*^9}, {3.617507665956772*^9, 3.617507700182831*^9}, {
   3.6175078031410913`*^9, 3.6175078085404387`*^9}, {3.6175078678820477`*^9, 
   3.6175078977748013`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6174873118817863`*^9, 3.617487312706361*^9}}],

Cell[CellGroupData[{

Cell[BoxData["column2"], "Input",
 CellChangeTimes->{
  3.617487256809001*^9, {3.617487465588101*^9, 3.61748746766463*^9}, {
   3.617496384516018*^9, 3.6174963889827747`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.24550016398865193`"}], ",", 
   RowBox[{"-", "0.3033010997459711`"}], ",", 
   RowBox[{"-", "0.3033010997459711`"}], ",", 
   RowBox[{"-", "0.26463315727691894`"}], ",", 
   RowBox[{"-", "0.24550016398865193`"}], ",", 
   RowBox[{"-", "0.3033010997459711`"}], ",", 
   RowBox[{"-", "0.23728711974077402`"}], ",", 
   RowBox[{"-", "0.21073613174803393`"}], ",", 
   RowBox[{"-", "0.1867976157436881`"}], ",", 
   RowBox[{"-", "0.16896480086039953`"}], ",", 
   RowBox[{"-", "0.1340722258097265`"}], ",", 
   RowBox[{"-", "0.1259389268428561`"}], ",", 
   RowBox[{"-", "0.11264320057359968`"}], ",", 
   RowBox[{"-", "0.07965077098014874`"}], ",", 
   RowBox[{"-", "0.05632160028679984`"}], ",", 
   RowBox[{"-", "0.09339880787184406`"}], ",", 
   RowBox[{"-", "0.34026824278590984`"}], ",", 
   RowBox[{"-", "0.21659645561824736`"}], ",", 
   RowBox[{"-", "0.1259389268428561`"}], ",", 
   RowBox[{"-", "0.09755187326032316`"}], ",", 
   RowBox[{"-", "0.16896480086039953`"}], ",", 
   RowBox[{"-", "0.15497580498714755`"}], ",", 
   RowBox[{"-", "0.1435924694495827`"}], ",", 
   RowBox[{"-", "0.09755187326032316`"}], ",", 
   RowBox[{"-", "0.1259389268428561`"}], ",", 
   RowBox[{"-", "0.07965077098014874`"}], ",", 
   RowBox[{"-", "0.025187785368571216`"}], ",", 
   RowBox[{"-", "7.66133540666841`*^-10"}], ",", 
   RowBox[{"-", "0.028160800143399924`"}], ",", 
   RowBox[{"-", "0.03562090767437602`"}], ",", 
   RowBox[{"-", "0.03982538549007436`"}], ",", 
   RowBox[{"-", "0.09755187326032316`"}], ",", 
   RowBox[{"-", "0.07965077098014874`"}], ",", 
   RowBox[{"-", "0.05632160028679984`"}], ",", 
   RowBox[{"-", "0.03982538549007436`"}], ",", 
   RowBox[{"-", "0.025187785368571216`"}], ",", 
   RowBox[{"-", "7.66133540666841`*^-10"}], ",", 
   RowBox[{"-", "0.028160800143399924`"}], ",", 
   RowBox[{"-", "0.03562090767437602`"}], ",", 
   RowBox[{"-", "0.043626523988505334`"}], ",", 
   RowBox[{"-", "0.04712203159039555`"}], ",", 
   RowBox[{"-", "0.09339880787184406`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.617487468426813*^9, {3.617487519945312*^9, 3.617487534508979*^9}, 
   3.617488195723605*^9, {3.6174946678923473`*^9, 3.617494672185792*^9}, {
   3.617494740440013*^9, 3.617494752984881*^9}, 3.6174947863130293`*^9, {
   3.617494870363122*^9, 3.617494906300291*^9}, 3.617495039093258*^9, 
   3.617495076463076*^9, {3.617496025910427*^9, 3.61749608029565*^9}, {
   3.61749622490933*^9, 3.6174962314873753`*^9}, {3.6174963732474403`*^9, 
   3.6174963895234413`*^9}, 3.617497450783617*^9, 3.617497921156837*^9, 
   3.617498320747096*^9, {3.61749837610363*^9, 3.617498401754524*^9}, 
   3.6174997302636003`*^9, {3.617499762750691*^9, 3.6174998058664417`*^9}, {
   3.61750018201784*^9, 3.617500205893034*^9}, {3.617500422344211*^9, 
   3.617500442203087*^9}, 3.6175077124718113`*^9, 3.6175077646782703`*^9, {
   3.6175078122747307`*^9, 3.6175079068705997`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["column3"], "Input",
 CellChangeTimes->{{3.617487462755068*^9, 3.617487462780592*^9}, {
  3.61748816971236*^9, 3.6174881724278316`*^9}, {3.617494758028843*^9, 
  3.617494758687503*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.578947368421053`*^-6", ",", "3.0000000000000005`*^-6", ",", 
   "3.0000000000000005`*^-6", ",", "3.940766550522649`*^-6", ",", 
   "4.578947368421053`*^-6", ",", "3.0000000000000005`*^-6", ",", 
   "4.901408450704225`*^-6", ",", "6.214285714285715`*^-6", ",", 
   "7.90909090909091`*^-6", ",", "9.666666666666665`*^-6", ",", 
   "0.00001535294117647059`", ",", "0.0000174`", ",", "0.00002175`", ",", 
   "0.0000435`", ",", "0.000087`", ",", "0.00003163636363636364`", ",", 
   "2.383561643835617`*^-6", ",", "5.8825622775800715`*^-6", ",", 
   "0.0000174`", ",", "0.000029000000000000004`", ",", 
   "9.666666666666665`*^-6", ",", "0.00001149056603773585`", ",", 
   "0.000013384615384615383`", ",", "0.000029000000000000004`", ",", 
   "0.0000174`", ",", "0.0000435`", ",", "0.00043500000000000006`", ",", 
   "4.7017580109747986`*^11", ",", "0.0003479999999999999`", ",", 
   "0.0002175`", ",", "0.00017400000000000003`", ",", 
   "0.000029000000000000004`", ",", "0.0000435`", ",", "0.000087`", ",", 
   "0.00017400000000000003`", ",", "0.00043500000000000006`", ",", 
   "4.7017580109747986`*^11", ",", "0.0003479999999999999`", ",", 
   "0.0002175`", ",", "0.000145`", ",", "0.00012428571428571428`", ",", 
   "0.00003163636363636364`"}], "}"}]], "Output",
 CellChangeTimes->{{3.617488173628821*^9, 3.617488195736205*^9}, {
   3.61749466790484*^9, 3.617494677904014*^9}, {3.617494740450863*^9, 
   3.617494786327746*^9}, 3.617494875275509*^9, 3.6174949063124933`*^9, 
   3.61749507647926*^9, {3.6174960259256153`*^9, 3.617496047467854*^9}, 
   3.617496224922216*^9, 3.617497450796947*^9, 3.617497921169284*^9, 
   3.617498320760397*^9, {3.617498376118196*^9, 3.6174984017688227`*^9}, 
   3.617499730278604*^9, {3.6174997627644978`*^9, 3.6174998058833523`*^9}, {
   3.617500182033655*^9, 3.617500205906765*^9}, {3.617500422357429*^9, 
   3.617500442214425*^9}, {3.617507830245964*^9, 3.617507906883102*^9}}]
}, Open  ]]
},
WindowSize->{740, 588},
WindowMargins->{{Automatic, -62}, {54, Automatic}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 5757, 140, 649, "Input"],
Cell[6317, 162, 2992, 68, 275, "Input"],
Cell[9312, 232, 94, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[9431, 237, 175, 3, 32, "Input"],
Cell[9609, 242, 2948, 57, 193, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12594, 304, 198, 3, 32, "Input"],
Cell[12795, 309, 1956, 30, 198, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
